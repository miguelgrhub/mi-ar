<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AR Markerless – Mi Mundito</title>
  <!-- A-Frame core -->
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <!-- Componente de hit-test para A-Frame -->
  <script src="https://unpkg.com/aframe-ar-hit-test-component@1.0.0/dist/aframe-ar-hit-test-component.min.js"></script>
  <style>body{margin:0;overflow:hidden;}</style>
</head>
<body>
  <a-scene
    vr-mode-ui="enabled: false"
    embedded
    renderer="colorManagement: true; physicallyCorrectLights: true;"
    webxr="mode: immersive-ar; optionalFeatures: hit-test;"
    ar-hit-test
  >
    <a-assets>
      <!-- Modelo glTF si quieres algo distinto a una esfera -->
      <!-- <a-asset-item id="model" src="mundito.glb"></a-asset-item> -->
    </a-assets>

    <!-- Retículo para apuntar al plano -->
    <a-entity id="reticle"
              ar-hit-test-reticle
              visible="false">
      <a-ring radius-inner="0.05" radius-outer="0.06"
              material="shader: flat; color: #00FF00">
      </a-ring>
    </a-entity>

    <!-- Aquí colocaremos la esfera cuando toques -->
    <a-sphere id="placed" radius="0.2" color="#2196F3" visible="false"></a-sphere>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    const scene   = document.querySelector('a-scene');
    const reticle = document.getElementById('reticle');
    const placed  = document.getElementById('placed');

    // Cuando el retículo detecte un plano, hazlo visible
    scene.addEventListener('ar-hit-test-started', () => {
      reticle.setAttribute('visible', true);
    });

    // Al tocar la pantalla, colocamos la esfera en la posición del retículo
    scene.addEventListener('ar-hit-test-select', () => {
      const pos = reticle.object3D.position;
      const rot = reticle.object3D.quaternion;
      placed.object3D.position.copy(pos);
      placed.object3D.quaternion.copy(rot);
      placed.setAttribute('visible', true);
    });
  </script>
</body>
</html>
